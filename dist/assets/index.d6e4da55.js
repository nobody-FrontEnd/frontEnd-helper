import{d as Q,aa as G,cM as K,r,a8 as X,b as R,a as t,w as i,u as g,o as T,j as h,ch as Y,t as E,F as P,e as Z,aQ as D,aR as L,bj as ee,cN as ae,cn as te,cd as oe,M as se,an as ne,h as u,_ as le}from"./index.fa3829f9.js";import{r as re,C as c}from"./index.43fb823d.js";import"./_commonjs-dynamic-modules.30ae7933.js";var ue=re();const F={MD5:c.algo.MD5,SHA1:c.algo.SHA1,SHA224:c.algo.SHA224,SHA256:c.algo.SHA256,SHA384:c.algo.SHA384,SHA512:c.algo.SHA512,SHA3:c.algo.SHA3,RIPEMD160:c.algo.RIPEMD160};let U;onmessage=y=>{switch(y.data.type){case"algorithm":U=F[y.data.value].create();break;case"update":const C=ue.create(y.data.value);U.update(C),postMessage({});break;case"finalize":const d=U.finalize().toString();postMessage({value:d});break}};const ce={class:"CheckSum"},pe={class:"ant-upload-drag-icon"},ie={class:"compare-area"},de={class:"compare-result"},me=Q({__name:"index",setup(y){const{t:C}=G();K("#00FF00");let d;const m=r(["MD5","SHA256"]),I=Object.keys(F).map(e=>e),n=r({map:new Map,obj:{}}),b=r(""),x=r(!1),k=r(""),A=r(new Map),M=r(""),H=r(!1),j=r({});function $(){if(b.value==="")return;A.value.clear();let e=b.value.trim();m.value.forEach(a=>{let s=n.value.map.get(a);e===s&&A.value.set(a,!0)}),k.value="error",M.value="",A.value.forEach((a,s)=>{k.value="success",M.value=s}),x.value=!0}async function z(){if(m.value.length!==0&&!(typeof d>"u")){H.value=!0;try{await Promise.all(m.value.map(e=>new Promise(async(a,s)=>{try{if(n.value.map.get(e)){a(!0);return}let l=0,p=B(e),_=d.stream().getReader();for(let v=await _.read();!v.done;v=await _.read())l+=v.value.byteLength,j.value[e]=l*100/d.size,await p.update(v.value);_.releaseLock();let f=await p.finalize();n.value.map.set(e,f),n.value.obj[e]=f,a(!0)}catch(l){s(l)}})))}catch(e){console.error(e)}finally{H.value=!1}}}async function O(e){return d=e,w.map(a=>{a.terminate()}),w=[],n.value.map.clear(),n.value.obj={},z(),!1}let w=[];X(()=>{w.map(e=>{e.terminate()})});function B(e){let a=new Worker(new URL(""+new URL("checksumWorker.033e31fa.js",import.meta.url).href,self.location),{type:"module"});return w.push(a),a.postMessage({type:"algorithm",value:e}),{update:s=>(a.postMessage({type:"update",value:s}),new Promise((l,p)=>{a.onmessage=l})),finalize:()=>(a.postMessage({type:"finalize"}),new Promise((s,l)=>{a.onmessage=p=>{s(p.data.value)}}))}}function N(e){let a=n.value.map.get(e);typeof a<"u"&&W(a)}function W(e){se.writeTextToClipboard(e),ne.success(C("common.copySuccess"))}return(e,a)=>{const s=u("a-upload-dragger"),l=u("a-checkbox-group"),p=u("a-spin"),_=u("a-progress"),f=u("a-input"),v=u("a-button"),V=u("a-tooltip"),q=u("a-input-group"),J=u("a-alert");return T(),R("div",ce,[t(g(oe),{class:"Checksum","max-width":1280},{one:i(()=>[t(s,{"max-count":1,"before-upload":O},{default:i(()=>[h("p",pe,[t(g(Y))]),h("p",null,E(e.$t("checksum.upload")),1)]),_:1}),t(p,{spinning:H.value},{default:i(()=>[t(l,{value:m.value,"onUpdate:value":a[0]||(a[0]=o=>m.value=o),class:"drag-box",options:g(I),onChange:z},null,8,["value","options"])]),_:1},8,["spinning"]),(T(!0),R(P,null,Z(m.value,o=>(T(),R(P,{key:o},[D(t(_,{class:"calculate-progress-bar",format:S=>S.toFixed(2)+"%",percent:j.value[o]},null,8,["format","percent"]),[[L,j.value[o]<100]]),t(q,{compact:"",class:"calculate-result"},{default:i(()=>[t(f,{value:n.value.obj[o],"onUpdate:value":S=>n.value.obj[o]=S,"addon-before":o,disabled:!0,style:{width:"calc(100% - 50px)"}},ee({_:2},[M.value===o?{name:"suffix",fn:i(()=>[t(g(ae))]),key:"0"}:void 0]),1032,["value","onUpdate:value","addon-before"]),t(V,null,{default:i(()=>[t(v,{onClick:S=>N(o)},{icon:i(()=>[t(g(te))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)],64))),128)),h("div",ie,[h("p",null,E(e.$t("checksum.prompt")),1),t(f,{value:b.value,"onUpdate:value":a[1]||(a[1]=o=>b.value=o),onChange:$},null,8,["value"])]),D(h("div",de,[D(t(J,{message:k.value==="success"?e.$t("checksum.success"):e.$t("checksum.failed"),type:k.value,"show-icon":""},null,8,["message","type"]),[[L,x.value]])],512),[[L,x.value]])]),_:1})])}}});const ge=le(me,[["__scopeId","data-v-898b2d37"]]);export{ge as default};
