import{d as j,r as c,v as F,H as O,a8 as U,y as E,X as B,an as D,o as _,b as w,a as p,w as g,u as N,dn as S,j as k,t as z,E as A,h as b}from"./index.fa3829f9.js";const T={key:0},$={style:{"margin-top":"8px"}},M=["src"],q=j({__name:"multiImagePicker",props:{pickHook:{type:Function,default:()=>{}},onLoadHook:{type:Function,default:()=>{}},removeHook:{type:Function,default:()=>{}}},setup(y,{expose:H}){const r=y,i=c(!1),m=c(""),u=c(""),t=F([]),s=[];O(()=>{V(),document.addEventListener("paste",h,!1)}),U(()=>{document.removeEventListener("paste",h)});const I=e=>{const a=t==null?void 0:t.findIndex(n=>n.uid===e.uid);t==null||t.splice(a,1),s==null||s.splice(a,1),r.removeHook()},x=()=>{t.length=0,s.length=0},P=e=>new Promise((a,n)=>{m.value=e.url||e.preview,i.value=!0,u.value=e.name||e.url.substring(e.url.lastIndexOf("/")+1)});E(()=>t,async(e,a)=>{await B(),r.onLoadHook()});const C=()=>{i.value=!1,u.value=""},R=e=>(t==null||t.push({uid:e.uid,name:e.name,status:"done",url:`file://${e.path}`}),f(e).then(a=>{const n=Object.assign(e,a);s.push(n),r.pickHook()}),!1),v=c(!1),V=()=>{navigator.clipboard.read().then(e=>{e[0].types[0].includes("image")?v.value=!0:v.value=!1}).catch(e=>{D.warn(e.toString())})},h=async e=>{var n;let a=(n=e.clipboardData)==null?void 0:n.items[0];if((a==null?void 0:a.kind)=="file"){let o=a.getAsFile();o&&o.size!==0&&(t==null||t.push({uid:o.uid,name:o.name,status:"done",url:URL.createObjectURL(o)}),f(o).then(d=>{const l=Object.assign(o,d);s.push(l),r.pickHook()}))}},f=e=>new Promise((a,n)=>{let o=new FileReader;o.readAsDataURL(e),o.onload=d=>{const l=new Image;l.src=d.target.result,l.onerror=n,l.onload=function(){a({width:this.width,height:this.height})}}});return H({fileList:s,clearImage:x}),(e,a)=>{const n=b("a-upload"),o=b("a-modal");return _(),w("div",null,[p(n,{accept:"image/*","file-list":t,"list-type":"picture-card","before-upload":R,multiple:"",onPreview:P,onRemove:I},{default:g(()=>[(t==null?void 0:t.length)<8?(_(),w("div",T,[p(N(S)),k("div",$,z(e.$t("image.choose")),1)])):A("",!0)]),_:1},8,["file-list"]),p(o,{visible:i.value,title:u.value,footer:null,onCancel:C},{default:g(()=>[k("img",{alt:"example",style:{width:"100%"},src:m.value},null,8,M)]),_:1},8,["visible","title"])])}}});export{q as _};
